include:
  - docassemble.AssemblyLine:assembly_line.yml
  - docassemble.ALAnyState:any_state.yml
  - docassemble.mlhframework:mlh_interview_framework.yml
---
metadata:
  title: |
    Motion to Change or Get Child Support
  short title: |
    Motion Regarding Child Support
  description: |-
    Use this tool to prepare forms to ask the court to change a Child Support Order, or to get a
    Child Support Order if you need one in a divorce case, custody case, paternity case, or other
    type of family court case.
  tags:
    - "Family"
  authors:
    - Bryce Willey
    - Amy Billmire
---
code: |
  interview_short_title = "Motion Regarding Child Support"
---
code: |
  github_repo_name = "docassemble-MLHMotionRegardingChildSupport"
---
code: |
  al_form_type = "existing_case"
---
code: |
  MLH_time_min = 20
  MLH_time_max = 60
---
# TODO(#1): the images are fairly small inside the collapsed templates; can we make them bigger?
objects:
  - image_court_papers: |
      DAStaticFile.using(
        filename="court_papers.jpg",
        alt=word("""
          A court form. The court information is circled in the top right; State of Michigan, Judicial District, Judicial Circuit, and County Probate.
          The case number is circled in the top left: 01-234 DM. Below those is the party information, including the plaintiffs' and defendants' names, and address
        """))
  - image_case_number: |
      DAStaticFile.using(
        filename="case_number.jpg",
        alt=word("A court form. The case number, 01-234 DM, is circled in the top right"))
  - image_uniform_order_date: |
      DAStaticFile.using(
        filename="date_of_order.jpg",
        alt=word("The third page of the uniform child support order. The date is at the bottom, to the left of the judge's name"))
  - image_plaintiff_or_defendant: |
      DAStaticFile.using(
        filename="plaintiff_or_defendant.jpg",
        alt=word("The plaintiff and defendant's names are circled, partially down the first page. The Plaintiff is on the left, and the defendant is on the right."))
  - image_support_amount: |
      DAStaticFile.using(
        filename="support_amount.jpg",
        alt=word("The first page of the uniform child support order. The amounts are at the bottom, in item number 3."))
  - image_subtotal_amount: |
      DAStaticFile.using(
        filename="subtotal_amount.png",
        alt=word("In the support table in the uniform child support order. The subtotal is the 4th row, and the value is the furthest right column with a value."))
---
objects:
  - users: ALPeopleList.using(auto_gather=True, complete_attribute="complete", target_number=1)
  - other_parties: ALPeopleList.using(auto_gather=True, complete_attribute="complete", target_number=1)
  - children: ALPeopleList.using(auto_gather=True, ask_number=True, complete_attribute="complete")
  - judge: ALPeopleList.using(ask_number=True,target_number=1)
---
# NOTE: for users and other_parties
generic object: ALIndividual
code: |
  x.name.first
  # TODO(#6): do we need to handle international addresses?
  x.address.address
  x.phone_number
  x.complete = True
---
# NOTE: ensures there is only 1 party on both sides
code: |
  users.there_is_another = False
---
code: |
  other_parties.there_are_any = True
---
code: |
  other_parties.there_is_another = False
---
code: |
  children[i].name.first
  children[i].birthdate
  children[i].complete = True
---
sections:
  - review_intro: "Introduction"
  - review_prior_case: "Prior Case Information"
  - review_your_info: "Your Information"
  - review_other_info: "Other Parent's Information"
  - review_children_info: "Children Information"
  - review_prior_order: "Prior Order Information"
  - review_agreement: "Agreement Information"
  - review_support_requested: "Support Requested Information"
  - review_conclusion: "Conclusion"
---
id: interview_order_motion_regarding_child_support
code: |
  nav.set_section("review_intro")
  intro_screen
  MLH_standard_intro_pages

  nav.set_section("review_prior_case")
  if not has_existing_case:
    existing_case_kickout
  what_you_will_need
  docket_number
  has_existing_support_order
  if has_existing_support_order:
    recent_judgment_date

  county_choice
  court_index
  the_court

  if not is_parent or third_party_named:
    parent_third_party_kickout

  nav.set_section("review_your_info")
  user_started_case
  public_record_fyi

  users.gather()
  nav.set_section("review_other_info")
  other_parties.gather()
  nav.set_section("review_children_info")
  children.gather()

  nav.set_section("review_prior_order")
  if has_existing_support_order:
    current_child_support_signpost
    who_paid
    subtotal_amount
    paid_child_care
    paid_medical_costs

  nav.set_section("review_agreement")
  if not agreed_on_who_pays:
    if not have_circumstances_changed:
      circumstances_kickout
    circumstance_changes

  nav.set_section("review_support_requested")
  support_formula_fyi
  who_pays_new
  base_support_new
  child_care_new
  ordinary_medical_new
  is_additional_amount_new
  asking_for_payer_benefits_credit

  nav.set_section("review_conclusion")
  # TODO(#7): do we need hearing info?
  #if has_hearing_info:
  #  hearing_at_court
  #  hearing_time
  #  judge.name
  #  judge_bar_number

  efile_notice
  if esign:
    signature_date
  
  interview_motion_regarding_child_support = True
---
mandatory: True
code: |
  interview_motion_regarding_child_support
  # Store anonymous data for analytics / statistics
  store_variables_snapshot(
      persistent=True,
      data={
          "zip": showifdef("users[0].address.zip"),
          "reached_interview_end": True,
      },
  )
  motion_child_support_download
---
id: intro screen
question: |
  Welcome to the Do-It-Yourself Motion to Change or Get Child Support tool
subquestion: |
  This tool can help you prepare the forms to file a *Motion Regarding Support* in Michigan.

  This tool is only for parents who:

  * Already have a child support order from a Michigan divorce, separate maintenance, paternity, custody, or family support case and want to ask the court to change the amount of child support; **OR**
  * Have filed a Michigan divorce, separate maintenance, paternity, custody, or family support case and want to ask the court to enter a child support order; **OR**
  * Have a Michigan judgment of divorce or separate maintenance, or a paternity or custody order which didn’t include child support, and want to ask the court to order child support in that case now.
continue button field: intro_screen
---
id: MLH intro landing
question: |
  Need more help?
subquestion: |
  This tool will help you prepare forms for your legal issue without a lawyer.
  
  You may want to speak to a lawyer if any of these apply to you:

  * You have a child support order **from another state** but you now live in Michigan.
      * Under certain circumstances, you may be able to have your case transferred to Michigan. However, this tool cannot help you do that.
  * There is a **bench warrant** against you for **non-payment of support**. This could happen if:
      * A motion to show cause was filed against you for non-payment of support,
      * You did not appear at the show cause hearing, and
      * The court issued a bench warrant against you.
  * You have any questions or aren't sure what to do.

  ${ MLH_GUIDE_FULL }
continue button field: MLH_intro_landing
---
id: has_existing_case
question: |
  Do you have an existing Michigan family court case?
subquestion: |
  If you do not already have an existing Michigan divorce, separate maintenance, paternity, custody, or family support case, return to [Michigan Legal Help](https://michiganlegalhelp.org/) for more information.
fields:
  - Do you have an existing Michigan family court case?: has_existing_case
    datatype: yesnoradio
---
id: existing_case_kickout
event: existing_case_kickout
question: |
  You cannot use this tool without a Michigan child support case
subquestion: |
  You said you already do not have an existing Michigan divorce, separate maintenance, paternity, custody, or family support case.
  You must have one to continue to use this tool.
  
  If you made a mistake, click the **Undo** button. Otherwise, click the **Exit** button to return to Michigan Legal Help.
buttons:
  - Exit: exit
    url: https://michiganlegalhelp.org
---
id: what_you_will_need
question: |
  What you will need to complete this form
subquestion: |
  To complete this form, you will need:

  * the case number,
  * court information, and
  * information about the parties from your existing case

  ${ collapse_template(where_info_on_papers_template) }
continue button field: what_you_will_need
---
template: where_info_on_papers_template
subject: |
  Where can I find this information?
content: |
  Here is an example of where you can find this information on your court papers.

  * The court information is circled in blue, on the top left.
  * The case number is circled in yellow, on the top right.
  * The information about the parties is circled in red

  ${ image_court_papers.show(width="100%") }
---
id: MLH intro time
question: |
  Using this tool
subquestion: |
  It should take you between ${ MLH_time_min } and ${ MLH_time_max } minutes to finish answering questions.
  After you answer all the questions, your personalized *Motion Regarding Support* will be ready to print.
  You will also get a *Uniform Child Support Order* without any numbers filled in.

  Depending on your court, you may get a referral to the Friend of the Court, and they may prepare
  a recommended support order for you. You can also use the
  [MiChildSupport Calculator](https://micase.state.mi.us/calculatorapp/public/welcome/load.html)
  on the Michigan Department of Health and Human Services website to calculate support, and
  transfer the numbers manually to the support order.
continue button field: MLH_intro_time
---
id: docket number
question: |
  What is your case number?
subquestion: |
  Enter the case number from your existing divorce, separate maintenance, paternity, custody, or family support case.

  ${ collapse_template(where_case_number) }
fields:
  - no label: docket_number
    maxlength: 25
---
template: where_case_number
subject: |
  Where can I find the case number?
content: |
  The case number is usually on the top right of your court forms. Below is an image where you can find this info.

  ${ image_case_number.show(width="100%") }
---
id: existing child support order
question: |
  Do you already have a child support order?
fields:
  - Do you have a child support order in your case ${ docket_number }: has_existing_support_order
    datatype: yesnoradio
  - note: |
      ${ collapse_template(where_date_uniform_child_order) }
    show if: has_existing_support_order
  - What date was the most recent judgment entered?: recent_judgment_date
    datatype: date
    max: ${ today() }
    show if: has_existing_support_order
---
template: where_date_uniform_child_order
subject: |
  Where can I find the date on my order forms?
content: |
  If your support order was entered on a Uniform Child Support Order form in Michigan,
  you can find the date the order was entered on the last page of the order.

  ${ image_uniform_order_date.show(width="100%") }

  If you have a different type of support order, the date that the order was entered is usually found at the end of the order, near the judge’s signature.
---
code: |
  court_index = next(court_list.filter_courts_by_2([county_choice], ['circuit'], column_1='address_county', column_2='type'))[0]
---
id: is_parent
question: |
  Are you the parent of the child or children this Motion Regarding Support is for?
fields:
  - no label: is_parent
    datatype: yesnoradio
---
id: third_party_named
question: |
  Is a third party (a non-parent) named in your existing family court case?
fields:
  - no label: third_party_named
    datatype: yesnoradio
---
id: parent_third_party_kickout
event: parent_third_party_kickout
question: |
  You cannot use this tool to prepare a Motion Regarding Support
subquestion: |
  This tool may only be used to prepare a Motion Regarding Support in an existing Michigan family court case between two parents, with no third-party involvement.

  If you made a mistake, click the **Undo** button. Otherwise, click the **Exit** button to return to Michigan Legal Help.
buttons:
  - Exit: exit
    url: https://michiganlegalhelp.org
---
id: what is the user's role?
question: |
  What party are you in your existing case?
subquestion: |
  You are called the “moving party” because you are filing this Motion Regarding Support.  

  In your existing divorce, separate maintenance, paternity, custody, or family support case, you are either the Plaintiff or the Defendant.

  What party are you in your case?

  ${ collapse_template(help_user_ask_role_template) }
fields: 
  - no label: user_ask_role
    datatype: radio
    choices:
      - I am the Plaintiff: plaintiff
      - I am the Defendant: defendant
  - note: |
      Okay, you are the **Plaintiff** in this case. The other 
      side is the Defendant.
    show if:
      variable: user_ask_role
      is: "plaintiff"
  - note: |
      Okay, you are the **Defendant** in this case. The other 
      side is the Plaintiff.
    show if:
      variable: user_ask_role
      is: "defendant"
---
# TODO(brycew): move this to mlhframework
template: help_user_ask_role_template
subject: |
  How do I know?
content: |
  You can find the parties by looking at the first page of an existing court document, like a complaint, petition, or answer. The top of the first page is the “caption” which has the basic case information. This area will list all of the parties in the case with their titles.

  ${ image_plaintiff_or_defendant.show(width="100%") }

  If you were the first person to file a form to start this case, you are the "Plaintiff". If someone else started this case by filing in court, you
  are the "Defendant".
---
question: |
  The information you put on your form is a public record
subquestion: |
  All of the information you supply, including your address and telephone information,
  will be included on forms that you file with the court and deliver to the Defendant.

  Keep in mind that your case file is a public record and anyone could ask to look at it and see your address and phone number.

  ${ collapse_template(confidential_how_to)}
continue button field: public_record_fyi
---
template: confidential_how_to
subject: |
  What if I'm afraid for my safety if this information is discovered by the other party or someone else
content: |
  To keep your address confidential, you need to have one of the following:

  * A Personal Protection Order or other order which keeps your address confidential, OR
  * On a [Uniform Child Custody Jurisdiction Enforcement Act Affidavit form](https://courts.michigan.gov/Administration/SCAO/Forms/courtforms/mc416.pdf),
    you need to state that you and/or your children’s safety would be at risk if you disclose your address.

  In either one of these scenarios, you can use a confidential address and phone number (such as the address and phone number
  of a friend or relative who has given their permission, or a Post Office Box) instead of your residential address and personal phone number.
---
id: persons contact information
generic object: ALIndividual
question: |
  What is ${x}'s phone number?
subquestion: |
  If you don't know, you can skip this question
fields:
  - Phone: x.phone_number
    required: False
---
id: how many children
question: |
  How many minor children is this support for?
fields:
  - no label: children.target_number
    datatype: integer
    min: 0
    validation messages:
      min: |
        You need to have at least one minor child that you are request support for.
---
id: minor birthdate question
question: |
  When was ${ children[i] } born?
fields:
  - Birthdate: children[i].birthdate
    datatype: BirthDate
    alMin: ${ format_date( today() - date_interval(years=18), format='MM/dd/yyyy') }
    alMinMessage: |
      This form is only for children under 18, but you said ${ children[i].name.familiar() } was over 18.
      Either correct the birth date, or ${ MLH_back_button_label.lower() } and add a different child under 18.
---
id: current_child_support_signpost
question: |
  Current amount of child support
subquestion: |
  In the next few questions we will ask you about the amounts of child support in your current order.

  You will be asked about base support, ordinary medical costs, and child care costs.

  ${ collapse_template(explain_base_support) }

  ${ collapse_template(where_support_amounts) }
continue button field: current_child_support_signpost
---
template: explain_base_support
subject: |
  Can you explain more?
content: |
  Base support is the ordinary monthly child support amount, for the general care and needs of a child.

  Ordinary medical costs are uninsured costs for things like office visits and prescription co-pays.

  ${ what_is_child_care.content }

  To learn more, read [Child Support in a Nutshell](https://michiganlegalhelp.org/resources/family/child-support-nutshell).
---
template: where_support_amounts
subject: |
  Where is the amount of support in the current support order?
content: |
  The support amounts can be found in the table at the bottom of the first page of your current support order,
  as seen in the red rectangle in the image below. 

  ${ image_support_amount.show(width="100%") }
---
id: who_paid
question: |
  Who was ordered to pay support in the current support order?
fields:
  - no label: who_paid
    choices:
      - Plaintiff (${ plaintiffs[0] }): plaintiff
      - Defendant (${ defendants[0] }): defendant
---
id: subtotal amount
question: |
  What is the subtotal amount on your current Uniform Child Support Order?
subquestion: |
  ${ collapse_template(where_subtotal_amount) }
fields:
  - no label: subtotal_amount
    datatype: currency
---
template: where_subtotal_amount
subject: |
  Where do I find the Subtotal amount?
content: |
  You can find the subtotal amount on the first page of the uniform child support order. It is highlighted in yellow
  in it's full table below.

  ${ image_subtotal_amount.show(width="100%") }
---
question: |
  Monthly child care costs
subquestion: |
  ${ what_is_child_care.content }
fields:
  - Was ${ plaintiffs[0].name.familiar() if who_paid == "plaintiff" else defendants[0].name.familiar() } ordered to pay monthly child care costs?: paid_child_care
    datatype: yesnoradio
  - How much in child care costs were they ordered to pay per month?: child_care_amount
    datatype: currency
    show if: paid_child_care
---
template: what_is_child_care
content: |
  Child care costs are used to allow a parent to work, look for work, or go to school.
  For most children the child care obligation ends around age 12, but it may be longer if the child’s health or safety requires it.
---
question: |
  Monthly Ordinary medical costs
subquestion: |
  Ordinary medical costs are uninsured costs for things like office visits and prescription co-pays.
  Ordinary medical costs are different than extraordinary uninsured health case costs, which are
  listed in a different part of the Uniform Child Support Order.
fields:
  - Was the ${ plaintiffs[0].name.familiar() if who_paid == "plaintiff" else defendants[0].name.familiar() } ordered to pay ordinary medical costs?: paid_medical_costs
    datatype: yesnoradio
  - How much in ordinary medical costs were they ordered to pay per month?: medical_care_amount
    show if: paid_medical_costs
---
question: |
  Have you and ${ other_parties } agreed on who should pay support and how much?
fields:
  - no label: agreed_on_who_pays
    datatype: yesnoradio
---
question: |
  Child Support Formula
subquestion: |
  The court must order support according to the Michigan Child Support Formula unless the result would be unfair.
  If the parents reach an agreement about the child support amount, the court can consider the
  agreement, but it does not have to approve it.

  You can use the [MiChildSupport Calculator](https://micase.state.mi.us/calculatorapp/public/welcome/load.html)
  on the Michigan Department of Health and Human Services website to find out what the support amount might be in your case.

  The Michigan Child Support Formula uses:

  * The parents' incomes
  * The number of nights per year (“overnights”) the children spend with each parent
  * The number of children
  * Medical costs
  * Child care costs
  * Other factors.

  To learn more, read [Child Support in a Nutshell](https://michiganlegalhelp.org/resources/family/child-support-nutshell).
continue button field: support_formula_fyi
---
question: |
  % if agreed_on_who_pays:
  In your agreement with ${ other_parties }, who are you asking the court to pay support?
  % else:
  Who are you asking the court to pay support?
  % endif
fields:
  - no label: who_pays_new
    choices:
      - Plaintiff (${ plaintiffs[0] }): plaintiff
      - Defendant (${ defendants[0] }): defendant
---
# TODO(brycew): helps go away when you try to type in the answer; how bad of a UX is that?
question: |
  % if agreed_on_who_pays:
  In the agreement, how
  % else:
  How
  % endif
  much per month are you asking the court to order for these costs?
fields:
  - Base support: base_support_new
    datatype: currency
    help: |
      Base support is the ordinary monthly child support amount, for the general care and needs of a child. 
  - Child care costs: child_care_new
    datatype: currency
    help: |
      ${ what_is_child_care.content }
  - Ordinary medical costs: ordinary_medical_new
    datatype: currency
    help: |
      Ordinary medical costs are uninsured costs for things like office visits and prescription co-pays.
---
question: |
  % if agreed_on_who_pays:
  In the agreement, are
  % else:
  Are
  % endif
  you asking the court to order an additional amount each month for other expenses?
fields:
  - no label: is_additional_amount_new
    datatype: yesnoradio
  - "Complete the following sentence. 'The reason for the other expenses is as follows:'": additional_amount_reason
    input type: area
    show if: is_additional_amount_new
  - How much per month are you asking the court to order for the other expenses?: additional_amount_new
    datatype: currency
    show if: is_additional_amount_new
---
variable name: benefit_types
data: !!omap
  - social_security: Social Security
  - veterans_administration: Veteran's Administration
  - railroad_retirement: Railroad Retirement
  - other: Other
---
objects:
  - benefit_types_ordered: DAOrderedDict.using(elements={**benefit_types}, auto_gather=False, gathered=True)
---
question: |
  % if agreed_on_who_pays:
  In the agreement, are
  % else:
  Are
  % endif
  you asking the court to give the payer of child support a credit each month for dependent benefits received from a government insurance program?
subquestion: |
  For example, the ${ who_pays_new } would receive a credit each month for benefits from Social Security, Veteran’s Administration, or railroad retirement.

  If the payer of child support receives retirement, survivor’s, or disability benefits from a government insurance program such as Social Security,
  Veteran’s Administration, or Railroad Retirement, his or her dependent children may also get benefits based on the payer’s work record. If this is so,
  the court will count the children’s benefits as a credit towards payment of the parent’s child support obligation. In other words, the amount of dependent
  benefits should be subtracted from the support amount.
fields:
  - Are you asking for the court to give ${ who_pays_new } a credit?: asking_for_payer_benefits_credit
    datatype: yesnoradio
  - What type of dependent benefit does your ${ "children" if len(children) > 1 else "child" } receive?: child_benefit_type
    datatype: radio
    code: |
      benefit_types_ordered
    show if: asking_for_payer_benefits_credit
  - How much is the monthly dependent benefit that the ${ "children get" if len(children) > 1 else "child gets" } from the government insurance program based on your work record?: child_benefit_amount
    datatype: currency
    show if: asking_for_payer_benefits_credit
---
id: have_circumstances_changed
question: |
  Have circumstances changed?
subquestion: |
  The court may only change the amount of child support if there has been a change in circumstances. Examples of changes in circumstances are:

  ${ circumstance_examples.content }

fields:
  - Have circumstances changed?: have_circumstances_changed
    datatype: yesnoradio
---
template: circumstance_examples
subject: What are some examples of changes in circumstances?
content: |
  * The needs of the children have changed;
  * There has been a change in custody;
  * The parent who pays child support has had a change in income; or
  * The parent who receives child support has had a change in income.
---
id: circumstance_changes
question: |
  How have your circumstances changed?
subquestion: |
  Explain in detail, and use complete sentences.

  Your answer will be attached to your *Motion Regarding Support*.
  It will help the court decide whether child support should be changed at this time.

  ${ collapse_template(circumstance_examples) }
fields:
  - no label: circumstance_changes
    input type: area
---
# TODO(brycew): Move this earlier in the interview?
id: circumstances_kickout
event: circumstances_kickout
question: |
  You cannot use this tool to prepare a Motion Regarding Support
subquestion: |
  Michigan law requires a change in circumstances for the court to change a child support order.

  If you made a mistake, click the **Undo** button. Otherwise, click the **Exit** button to return to Michigan Legal Help.
buttons:
  - Exit: exit
    url: https://michiganlegalhelp.org
---
# TODO(brycew): copied from LHI, adjust text to what's actually in our form
question: |
  Completing this process does not file your forms with the court
subquestion: |
  You need to file them at court in person, by mail, e-mail, or by e-filing.
  If you are e-filing, you must use [MiFILE](https://mifile.courts.michigan.gov/).
  Read the instructions that you will get with your forms for more information.

  ${ collapse_template(am_i_going_to_efile) }

  This tool will create separate forms so you can more easily e-file using MiFILE, if you plan to e-file.
  This means that you may need to download multiple files to get all of the forms you will need.

  You will be able to get all forms you need by clicking the Download Your Form(s) button on the page at the end of this tool.
  You will then see a list of documents to download. Make sure you download each of them.
continue button field: efile_notice
---
template: am_i_going_to_efile
subject: |
  How do I know if I am going to e-file?
content: |
  Not all courts offer e-filing at this time. To find out if your court has e-filing, read the
  [What is E-Filing?](https://michiganlegalhelp.org/resources/mifile/what-e-filing) article.
  The article tells you how to find out which courts have e-filing and what kinds of cases those courts are accepting by e-filing.

  Look for the two-letter case type code at the end of your case number.
  (This could be DM, DC, DS, DP, or a different code.)
---
question: |
  Electronic Signature
subquestion: |
  This tool can put "*/s/ ${ users[0] }*" where you would sign your name so you do not have to sign the form by hand. The court will accept this as your signature.

  If you plan to e-file, you may want to add your electronic signature, otherwise you will need to print your forms, sign them by hand, and then scan them.

  ${ collapse_template(efiling_info_template) }
fields:
  - Would you like to add your electronic signature to your form?: esign
    datatype: yesnoradio
---
id: download child support motion
event: motion_child_support_download
question: |
  All done
subquestion: |
  Thank you ${users}. Your form is ready to download and deliver.
  
  View, download and send your form below. Click the "Edit answers" button to fix any mistakes.

  ${ action_button_html(url_action('review_form'), label='Edit answers', color='info') }
  
  ${ al_user_bundle.download_list_html() }

  ${ al_user_bundle.send_button_html(show_editable_checkbox=False) }
progress: 100
---
id: Do you know hearing time and place
question: |
  Motion Hearing Information
subquestion: |
  Have you already contacted the court to find out:
  
  * when the hearing will be
  * where the hearing will be, and
  * what judge will run the hearing?
under: |  
 **For most people, the answer will be no.**  
 
 Most people will get the judge and hearing information **after** they file this motion with the court.  We will give you more instructions when you finish this tool.
fields:
  - no label: has_hearing_info
    datatype: yesnoradio
---
if: has_hearing_info
id: When will the hearing be
question: |
  When will the hearing be?
fields:
  - "Date of hearing": hearing_date
    datatype: date
    required: False
    min: ${ today() }
  - "Hearing Time": hearing_time
    maxlength: 13
    required: False
    #removed "time" datatype due to failure on some older Androids and weird interface.
---
if: has_hearing_info
id: Will the hearing be held at the courthouse
question: |
  Where will the hearing be?
fields:
  - "Will the hearing be in person at the courthouse?": hearing_at_court
    datatype: yesnoradio
    required: False
  - "* Type the address if it will be at a physical location. * If the hearing will be online or by phone, briefly explain.": hearing_address_on_one_line
    show if:
      variable: hearing_at_court 
      is: False
    maxlength: 50 
---
if: has_hearing_info
id: Judge information
question: |
  What judge will hear your motion?
subquestion: |
  What is the name and bar number (or "P-Number") of the judge who will hear this motion?
fields:
  - "Judge's name": judge.name
    maxlength: 35
    required: False
  - "Judge's bar number": judge_bar_number
    maxlength: 7
    required: False
---
############
## Overridden questions from AL
############
---
sets:
  - other_parties[i].name.first
  - other_parties[i].name.last
  - other_parties[i].name.middle
  - other_parties[i].name.suffix
id: names of opposing parties
question: |
  % if user_started_case:
  Name of **defendant** in this matter
  % else:
  Name of **plaintiff** in this matter
  % endif
fields:
  - code: |
      other_parties[i].name_fields(person_or_business='person')
---
id: children names without birthdate
sets:
  - children[i].name.first
  - children[i].name.last
  - children[i].name.middle
  - children[i].name.suffix
question: |
  What is the name of your ${ ordinal(i) } child?
subquestion: |
  % if len(children.complete_elements()) > 0:
  You have already told us about ${ comma_and_list(children.complete_elements()) }.
  % endif
fields:
  - code: |
      children[i].name_fields()
---
include:
  - review.yml
---
#######################################################
##### Documents 
#######################################################
objects:
  - mrcs_instructions: ALDocument.using(title="Instructions", filename="Instructions.docx", enabled=True, has_addendum=False)
  - mrcs_attachment_main: ALDocument.using(title="Motion Regarding Support", filename="Motion Regarding Support - FOC 50.pdf", enabled=True, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  - mrcs_attachment_addendum: ALDocument.using(title="Motion Regarding Support Addendum", filename="Motion Regarding Support Addendum.docx", enabled=True)
  - mrcs_foc10: ALDocument.using(title="Uniform Child Support Order", filename="Uniform Child Support Order - FOC 10.pdf", enabled=True, has_addendum=False)
  - mrcs_foc10d: ALDocument.using(title="Uniform Child Support Order Deviation Addendum", filename="Uniform Child Support Order Deviation Addendum - FOC 10d.pdf", enabled=True, has_addendum=False)
---
objects:
  - mrcs_attachment: ALDocumentBundle.using(elements=[mrcs_attachment_main, mrcs_attachment_addendum], filename="Motion RegardingSupport - FOC 50.pdf", title="Motion Regarding Support", enabled=True)
---
objects:
  - al_user_bundle: ALDocumentBundle.using(elements=[mrcs_instructions, mrcs_attachment, mrcs_foc10, mrcs_foc10d], filename="Motion Regarding Child Support (All Forms).pdf", title="All forms to download for your records", enabled=True)
  - al_court_bundle: ALDocumentBundle.using(elements=[mrcs_attachment, mrcs_foc10, mrcs_foc10d], filename="Motion Regarding Child Support (All Forms).pdf", title="All forms to download for your records", enabled=True)
---
attachment:
  variable name: mrcs_attachment_addendum[i]
  docx template file: Motion Regarding Support Addendum.docx
---
code: |
  # TODO(brycew): we don't really need to treat the addendum like an addendum?
  # `circumstance_changes` go in it, but also structured info about other payments.
  # Should just be a DOCX template, wrapped with a bundle for the mrcs_attachment.
  mrcs_attachment.overflow_fields.gathered = True
---
attachment:
  name: Motion Regarding Support Instructions
  filename: Instructions
  variable name: mrcs_instructions[i]
  skip undefined: True
  docx template file: mrcs_next_steps.docx
---
attachment:
  name: Motion Regarding Support Attachment
  filename: Motion Regarding Support - FOC 50
  variable name: mrcs_attachment_main[i]
  skip undefined: True
  pdf template file: Motion Regarding Support - FOC 50.pdf
  editable: False
  fields:
    - trial_court_circuit: |
          % if the_court.type == 'circuit':
          ${ the_court.number }
          % endif
    - trial_court_district: |
          % if the_court.type == 'district':
          ${ the_court.number }
          % endif
    - docket_number: ${ docket_number }
    - trial_court_address_on_one_line: ${ the_court.address.on_one_line() }
    - trial_court_phone_number: ${ the_court.phone }
    - plaintiff_is_moving_party: ${ user_started_case }
    - defendant_is_moving_party: ${ not user_started_case }
    - third_party_is_moving_party: False
    - plaintiffs: |
          ${ plaintiffs }  
          ${ plaintiffs[0].address.block() }
    - defendants: |
          ${ defendants }  
          ${ defendants[0].address.block() }
    - third_parties: ""
    - judgment_entered: ${ has_existing_support_order }
    - judgment_entered_date: ${ recent_judgment_date }
    - no_support_order: ${ not has_existing_support_order }
    - paid_support_costs: ${ has_existing_support_order }
    - plaintiff_pays_support: ${ who_paid == "plaintiff" }
    - defendant_pays_support:  ${ who_paid == "defendant" }
    - support_amount: ${ thousands(subtotal_amount, show_decimals=True) }
    - paid_child_care: ${ paid_child_care }
    - plaintiff_pays_care: ${ paid_child_care and who_paid == "plaintiff" }
    - defendant_pays_care: ${ paid_child_care and who_paid == "defendant" }
    - child_care_amount: ${ thousands(child_care_amount if paid_child_care else "", show_decimals=True) }
    - paid_medical_costs: ${ paid_medical_costs }
    - plaintiff_pays_medical: ${ paid_medical_costs and who_paid == "plaintiff" }
    - defendant_pays_medical: ${ paid_medical_costs and who_paid == "defendant" }
    - medical_care_amount: ${ thousands(medical_care_amount if paid_medical_costs else "", show_decimals=True) }
    - conditions_have_changed: ${ have_circumstances_changed }
    - other_parties: ${ other_parties if agreed_on_who_pays else "" }
    - is_new_agreement: ${ agreed_on_who_pays }
    - is_new_agreement__2: ${ agreed_on_who_pays }
    - signature_date: ${ signature_date if esign else "" }
    - users1_signature: ${ f"/s/ {users[0]}" if esign else "" }
    #- judge_name: ${ judge.name if has_hearing_info else "" }
    #- judge_bar_number: ${ judge_bar_number if has_hearing_info else "" }
    #- hearing_date: ${ format_date(hearing_date) if has_hearing_info else "" }
    #- hearing_time: ${ hearing_time if has_hearing_info else "" }
    #- hearing_address_on_one_line: ${ hearing_address_on_one_line if has_hearing_info else "" }
    - service_signature_date: 
    - service_signature:
    # Unused button : ___instructions_link____
---
attachment:
  name: Uniform Child Support Order
  variable name: mrcs_foc10[i]
  skip undefined: True
  editable: True
  pdf template file: Uniform Child Support Order - FOC 10.pdf
  fields:
    - trial_court_circuit: |
          % if the_court.type == 'circuit':
          ${ the_court.number }
          % endif
    - trial_court_district: |
          % if the_court.type == 'district':
          ${ the_court.number }
          % endif
    - CASE NO: ${ docket_number }
    - trial_court_address_on_one_line: ${ the_court.address.on_one_line() }
    - trial_court_phone_number: ${ the_court.phone }
    - plaintiffs: |
          ${ plaintiffs }  
          ${ plaintiffs[0].address.block() }
    - defendants: |
          ${ defendants }  
          ${ defendants[0].address.block() }
    - plaintiffs_attorney: 
    - defendants_attorney: 
    - children1: ${ children[0] }
    - children2: ${ children[1] if len(children) > 1 else "" }
    - children3: ${ children[2] if len(children) > 2 else "" }
    - children4: ${ children[3] if len(children) > 3 else "" }
    - children5: ${ children[4] if len(children) > 4 else "" }
    - children6: ${ children[5] if len(children) > 5 else "" }
    - children7: ${ children[6] if len(children) > 6 else "" }
    # TODO(brycew): continue here
---
attachment:
  name: Uniform Child Support Order Deviation Addendum
  variable name: mrcs_foc10d[i]
  skip undefined: True
  editable: True
  pdf template file: Uniform Child Support Order Deviation Addendum - FOC 10d.pdf
  fields:
    - trial_court_circuit: |
          % if the_court.type == 'circuit':
          ${ the_court.number }
          % endif
    - trial_court_district: |
          % if the_court.type == 'district':
          ${ the_court.number }
          % endif
    - docket_number: ${ docket_number }
    - trial_court_address_on_one_line: ${ the_court.address.on_one_line() }
    - CASE NO: ${ docket_number }
    - trial_court_address_on_one_line: ${ the_court.address.on_one_line() }
    - trial_court_phone_number: ${ the_court.phone }
    - plaintiffs: ${ plaintiffs }
    - defendants: ${ defendants }
    - children1: ${ children[0] }
    - children2: ${ children[1] if len(children) > 1 else "" }
    - children3: ${ children[2] if len(children) > 2 else "" }
    - children4: ${ children[3] if len(children) > 3 else "" }
    - children5: ${ children[4] if len(children) > 4 else "" }
    - children6: ${ children[5] if len(children) > 5 else "" }
    - children7: ${ children[6] if len(children) > 6 else "" }
    # TODO(brycew): continue here

