# example date for testing
code: |
  marriage.date = "2015-07-20T00:00:00-04:00" 
---
# example interview tag for testing
code: |
  divorce_custody_interview_ID = "JOD_only"
---
### need the stuff in this section (copied from main yml) here for now to run just this yml
generic object: DAList
template: x.collapsed_table_template
subject: |
  So far, you have listed...
content: |
  ${x.table.show(editable=False)}
---
features:
  labels above fields: True
---
generic object: DAList
template: x.question_table_template
content: |
  % if x.number_gathered() > 1:
  ${collapse_template(x.collapsed_table_template)}
  % endif
---
include:
  - docassemble.AssemblyLine:assembly_line.yml
  - docassemble.ALToolbox:collapse_template.yml
  - docassemble.mlhframework:mlh_interview_framework.yml
---
code: |
  github_repo_name = 'docassemble-MLHDivorceAndCustody'
---
objects:
  - children: ALPeopleList.using(
      complete_attribute="complete",
      )
  - marriage: DAObject
### need the above for now to run just this yml
---
### possibly move the below to main yml
terms:
  - phrases:
      - assisted reproduction
    definition: |
      Assisted reproduction is a way to become pregnant that is not sexual intercourse. It includes:

      * Donor insemination
      * Sperm or egg donation
      * Embryo donation
      * In vitro fertilization (IVF) and embryo transfer
      * Intracytoplasmic sperm injection
      * Assisted reproductive technology
  - phrases:
      - parenting time
    definition: |
      Sometimes called "visitation".
  - phrases:
      - minor
    definition: |
      A child is a minor if they are 17 years old or younger.
      
---
table: children.table
rows: children
columns:
  - Name: row_item.name
  - Date of birth: row_item.birthdate
  - Entered family before or during marriage: |
      "before marriage" if row_item.timing == "premarital" else "during marriage"
edit:
  - name.first
  - timing
  - origin
  - bio_parent
  - parentage_established
  - legal_parent
  - not_included_in_divorce_info
  - parentage_revocation_info
  - complicated_issue_kickout
  - show_parentage_info # just for testing purposes
delete buttons: True
confirm: True
---
id: child questions
mandatory: True # remove later
code: |
  children_intro
  children.gather()
  legal_custody_who
  if PT_type == "specific":
    specific_PT_how
  test_end_screen
---
code: |
  children[i].name.first
  children[i].timing 
  children[i].origin

  if children[i].origin == "marital_third_party_conceived" and children[i].how_conceived == "assisted_reproduction":
    children[i].complicated_issue_kickout
  
  children[i].legal_parent

  if children[i].legal_parent != "both":
    children[i].not_included_in_divorce_info
  
  elif ((children[i].origin == "premarital_with_another" and (children[i].parentage_established == "affidavit" or children[i].parentage_established == "court_order") and children[i].how_conceived == "sex") or (children[i].origin == "marital_third_party_conceived" and children[i].legal_parent == "both")) and children[i].parentage_plan_to_revoke:
    children[i].parentage_revocation_info

  elif children[i].origin == "premarital_with_another" and (children[i].parentage_established == "affidavit" or children[i].parentage_established == "court_order") and children[i].how_conceived == "assisted_reproduction":
    children[i].complicated_issue_kickout

  children[i].show_parentage_info

  children[i].complete = True
---
id: other_parties_0_gender
question: |
  What is your spouse's gender?
fields:
  - code: |
      other_parties[0].gender_fields(show_help=True)
---
id: users_0_pregnant
question: |
  Pregnancy
fields:
  - label: To the best of your knowledge are you pregnant?
    field: users[0].pregnant
    datatype: yesnoradio
---
id: other_parties_0_pregnant
question: |
  Pregnancy
fields:
  - label: To the best of your knowledge is your spouse pregnant?
    field: other_parties[0].pregnant
    datatype: yesnoradio
#---
#id: children_there_are_any_same_sex
#question: |
# Children
#fields:
#  - label: Do you and your spouse have minor children together?
#    field: children_there_are_any_same_sex
#    datatype: yesnoradio
#---
#id: children_both_legal_parents
#question: |
#  Children
#subquestion: |
#  You are both the legal parents if one of you is a biological parent and you were married to each other when the child was born or conceived.
#fields:
#  - label: Are you and your spouse both the legal parents of the child or children?
#    field: children_both_legal_parents
#    datatype: yesnomaybe
#---
#code: |
#  if users[0].gender == other_parties[0].gender:
#    if children_there_are_any_same_sex and children_both_legal_parents:
#      children.there_are_any = True
#    else:
#      children.there_are_any = False
#  else:
#    pass
---
id: children intro
continue button field: children_intro
question: Children
subquestion: |
  This tool will ask questions about {minor} children next.
  
  ${ collapse_template(minor_children_info) }

  ${ collapse_template(adult_children_info) }
---
template: minor_children_info
subject: |
  More info on minor children and divorce
content: |
  If you and your spouse have any **minor children together**, your divorce must address custody, parenting time, and child support. 
  
  **Minor children of just one spouse** must also be listed in the divorce paperwork. However, the divorce will not cover their custody, parenting time, or child support.
---
template: adult_children_info
subject: |
  **Important**: children who are 18 to 19-and-a-half years old
content: |
  If you and your spouse have a **child between 18 years old and 19 years and 6 months**, it is possible to ask the court for child support if:

  * The child is enrolled full time in high school,
  * You reasonably expect the child to graduate, and
  * The child lives with one parent full time.

  If all of these things are true and you ask for child support, the judge may grant the request. It is not a guarantee. This can be complicated. If this is your child’s situation and you want to ask for child support, you may want to talk to a lawyer. ${MLH_GUIDE_FULL} 
  
  You can make your divorce forms using this tool, but the forms **will not** include a child support request for an adult child.
---
id: any children
question: |
  Minor children
fields:
  - Do you or your spouse have any living {minor} children? This includes children you had together and children you had separately.: children.there_are_any
    datatype: yesnoradio
---
id: any more children
question: |
  Any more children?
subquestion: |
  Please list **all minor children** that you or your spouse have, either separately or together.
  
  You have already told us about:

  ${children.table}
fields:
  - Are there any more minor children to add?: children.there_is_another
    datatype: yesnoradio
---
on change:
  children.there_are_any: |
    if not children.there_are_any:
      children.target_number = 0
      children.clear()
---
id: children info
sets:
  - children[i].name.first
  - children[i].name.middle
  - children[i].name.last
  - children[i].name.suffix
question: |
  ${ capitalize(ordinal(i)) } child's information
subquestion: |
  ${children.question_table_template}
fields:
  - code: |
      children[i].name_fields()
  - Date of birth: children[i].birthdate
    datatype: BirthDate
  - My spouse and I **adopted** this child together during our marriage.: children[i].adopted_during_marriage
    required: False
    datatype: yesno
  # need help text saying don't include children who were born to or adopted by either spouse prior to marriage
  - Gender: children[i].gender
    datatype: radio
    choices:
      - Female: female
      - Male: male
  - Social security number: ssn
    datatype: ssn
    required: False
---
code: |
  if children[i].adopted_during_marriage:
    children[i].timing = "marital"
    children[i].origin = "adoption"
  else:
    if int(date_difference(starting=marriage.date, ending=children[i].birthdate).days) < 0:
      children[i].timing = "premarital"
    elif int(date_difference(starting=marriage.date, ending=children[i].birthdate).days) > 0:
      children[i].timing = "marital"
---
if: not children[i].adopted_during_marriage and int(date_difference(starting=marriage.date, ending=children[i].birthdate).days) == 0
Question: Which was first?
fields:
  - Was ${children[i]} born before or after you got married?: children[i].timing
    datatype: radio
    choices: 
      - ${children[i]} was born before we got married.: premarital
      - ${children[i]} was born after we got married.: marital
---
id: marital children's origin
if: children[i].timing == "marital" and not children[i].adopted_during_marriage
question: |
  About ${children[i]}
fields:
  - Who gave birth to ${children[i]}?: children[i].marital_birth
    datatype: radio
    choices:
      - "**My spouse or I** gave birth to ${children[i]}.": True
      - "**Someone else** gave birth to ${children[i]}.": False
  - Which of these applies to ${children[i]}?: children[i].origin
    datatype: radio
    choices:
      - My spouse and I had ${children[i]} together through sex or assisted reproduction.: marital_sex_AR
      - My spouse or I had ${children[i]} with somebody else.: marital_third_party_conceived
    show if:
      variable: children[i].marital_birth 
      is: True
  - Which of these applies to ${children[i]}?: children[i].origin
    datatype: radio
    choices:
      - ${children[i]} was born through a surrogacy agreement.: marital_surrogacy
      - My spouse or I conceived ${children[i]} with someone else. That other person gave birth to ${children[i]}.: third_party_birth
    show if:
      variable: children[i].marital_birth
      is: False
  - note: |
      ${ collapse_template(why_ask_child_origin) }
      ${ collapse_template(help_assisted_repro) }
---
id: extramarital third party birth
if: children[i].timing == "marital" and children[i].origin == "third_party_birth"
question: ${children[i]}'s legal parent 
subquestion: ${ collapse_template(why_ask_child_origin) }
fields:
  - Who is ${children[i]}'s biological parent?: children[i].legal_parent
    datatype: radio
    choices:
      - I am.: user
      - My spouse is.: other_party
---
template: why_ask_child_origin
subject: |
  Why are you asking this?
content: |
  Depending on your answer, we may need to give you more information about parentage.
---
template: help_assisted_repro
subject: |
  What does "assisted reproduction" mean?
content: |
  Assisted reproduction is a way to become pregnant that is not sexual intercourse. It includes:
  
    * Donor insemination
    * Sperm or egg donation
    * Embryo donation
    * In vitro fertilization (IVF) and embryo transfer
    * Intracytoplasmic sperm injection
    * Assisted reproductive technology
---
id: adopted child set origin and legal parents
code: |
  if children[i].adopted_during_marriage:
    children[i].origin = "marital_adoption"
    children[i].legal_parent = "both"
---
id: set legal parents for certain situations
code: |
  if children[i].origin == "marital_sex_AR":
    children[i].legal_parent = "both"
  elif children[i].origin == "premarital_with_spouse" and children[i].how_conceived == "premarital_sex_or_assisted_repro_with_spouse" and (children[i].parentage_established == "yes" or (children[i].parentage_established == "unknown" and children[i].both_on_birth_cert == True)):
    children[i].legal_parent = "both"
  elif children[i].origin == "premarital_with_another" and children[i].parentage_established == "stepparent_adoption": 
    children[i].legal_parent = "both"
  elif children[i].origin == "premarital_with_another" and children[i].parentage_established == "no":
    children[i].legal_parent = children[i].bio_parent
  elif children[i].origin == "premarital_with_another" and (children[i].parentage_established == "affidavit" or children[i].parentage_established == "court_order") and children[i].how_conceived == "assisted_reproduction":
    children[i].legal_parent = "both"
  
---
id: premarital children's origin
if: children[i].timing == "premarital" 
question: |
  About ${children[i]}
fields:
  - Which of these applies to ${children[i]}?: children[i].origin
    datatype: radio
    choices:
      - My current spouse and I had ${children[i]} **together**.: premarital_with_spouse
        help: |
          This includes children conceived through sex, assisted reproduction, or a surrogacy agreement.
      - My current spouse or I had ${children[i]} **with someone else**.: premarital_with_another
        help: |
          This includes children who were conceived through sex, assisted reproduction, or a surrogacy agreement, or who were adopted.
      - My current spouse or I had ${children[i]} **alone**, through a **single-parent adoption** or through **assisted reproduction *without*** another parent.: premarital_alone
        help: |
          This answer is only for someone who became a single parent **on purpose** through:
          
          * adoption or 
          * assisted reproduction. 
          
          If there *was* another parent but they did not or could not act as a parent, choose a different answer.
  - How was ${children[i]} conceived?: children[i].how_conceived
    datatype: radio
    choices:
      - By sexual intercourse or assisted reproduction: premarital_sex_or_assisted_repro_with_spouse
      - Through a surrogacy agreement: premarital_surrogacy_with_spouse
    show if:
      variable: children[i].origin
      is: premarital_with_spouse
  - Who had ${children[i]} with someone else?: children[i].bio_parent
    datatype: radio
    choices:
      - I did.: user
      - My spouse did.: other_party
    show if:
      variable: children[i].origin
      is: premarital_with_another
  - note: |
      ${ collapse_template(why_ask_child_origin) }
      ${ collapse_template(help_assisted_repro) }
---
id: premarital children of sex, assisted repro
if: children[i].timing == "premarital" and children[i].origin == "premarital_with_spouse" and children[i].how_conceived == "premarital_sex_or_assisted_repro_with_spouse" and children[i].bio_parent == "user"
question: ${children[i]}'s legal parents 
subquestion: ${ collapse_template(why_ask_child_origin) }
fields:
  - Did your spouse become a legal parent of ${children[i]}?: children[i].parentage_established
    datatype: radio
    choices:
      - Yes: yes
      - No: no
      - I don't know.: unknown
  - note: |
      **Before you can use this tool** to get divorce forms, your spouse needs to become a legal parent so your divorce can include custody, parenting time, and child support for all children in common. To learn more, read [How to Become a Legal Parent](https://michiganlegalhelp.org/resources/family/how-become-legal-parent).
    show if:
      variable: children[i].parentage_established
      is: no
  - Are both your and your spouse's names listed on ${children[i]}'s birth certificate as parents?: children[i].both_on_birth_cert
    datatype: yesnoradio
    show if: 
      variable: children[i].parentage_established
      is: unknown
  - note: |
      If your spouse is not listed on the birth certificate, this could mean either that:
      
      * you are the only legal parent, **or**
      * the birth certificate was not updated after your spouse became a legal parent. 
      
      Make sure that your spouse is a legal parent **before you use this tool** to get divorce forms. This is so your divorce can include custody, parenting time, and child support for all your children in common with your spouse. To learn more, read [How to Become a Legal Parent](https://michiganlegalhelp.org/resources/family/how-become-legal-parent).
    show if:
      variable: children[i].both_on_birth_cert
      is: False
validation code: |
  if children[i].parentage_established == "no":
    validation_error("Both parents must become legal parents before you can use this tool to get divorce forms.", field="children[i].parentage_established")
  elif children[i].parentage_established == "unknown" and children[i].both_on_birth_cert == False:
    validation_error("Both parents must become legal parents before you can use this tool to get divorce forms.", field="children[i].both_on_birth_cert")
---
id: premarital children of sex, assisted repro
if: children[i].timing == "premarital" and children[i].origin == "premarital_with_spouse" and children[i].how_conceived == "premarital_sex_or_assisted_repro_with_spouse" and children[i].bio_parent == "other_party"
question: ${children[i]}'s legal parents 
subquestion: ${ collapse_template(why_ask_child_origin) }
fields:
  - Did you become a legal parent of ${children[i]}?: children[i].parentage_established
    datatype: radio
    choices:
      - Yes: yes
      - No: no
      - I don't know.: unknown
  - note: |
      **Before you can use this tool** to get divorce forms, you need to become a legal parent so your divorce can include custody, parenting time, and child support for all children in common. To learn more, read [How to Become a Legal Parent](https://michiganlegalhelp.org/resources/family/how-become-legal-parent).
    show if:
      variable: children[i].parentage_established
      is: no
  - note: |
  - Are both your and your spouse's names listed on ${children[i]}'s birth certificate as parents?: children[i].both_on_birth_cert
    datatype: yesnoradio
    show if: 
      variable: children[i].parentage_established
      is: unknown
  - note: |
      If you are not listed on the birth certificate, this could mean either that:
      
      * your spouse is the only legal parent, **or** 
      * the birth certificate was not updated after you became a legal parent. 
      
      Make sure that you are a legal parent **before you use this tool** to get divorce forms. This is so your divorce can include custody, parenting time, and child support for all your children in common with your spouse. To learn more, read [How to Become a Legal Parent](https://michiganlegalhelp.org/resources/family/how-become-legal-parent).
    show if:
      variable: children[i].both_on_birth_cert
      is: False
validation code: |
  if children[i].parentage_established == "no":
    validation_error("Both parents must become legal parents before you can use this tool to get divorce forms.", field="children[i].parentage_established")
  elif children[i].parentage_established == "unknown" and children[i].both_on_birth_cert == False:
    validation_error("Both parents must become legal parents before you can use this tool to get divorce forms.", field="children[i].both_on_birth_cert")
---
id: premarital solo child
if: children[i].origin == "premarital_alone"
question: About ${children[i]}
fields:
  - Who had ${children[i]} on their own before the marriage?: children[i].bio_parent
    datatype: radio
    choices:
      - I did.: user
      - My spouse did.: other_party
  - Did you become ${children[i]}'s legal parent through adoption, Affidavit of Parentage, or another court order (like a *Judgment of Parentage*)?: children[i].legal_parent
    datatype: radio
    choices:
      - Yes: both
      - No: other_party   # NOTE: does this work????   
    show if:
      variable: children[i].bio_parent
      is: other_party
  - Did your spouse become ${children[i]}'s legal parent through adoption, Affidavit of Parentage, or another court order (like a *Judgment of Parentage*)?: children[i].legal_parent
    datatype: radio
    choices:
      - Yes: both
      - No: user     # NOTE: does this work????   
    show if:
      variable: children[i].bio_parent
      is: user
---
id: surrogacy agreement compliance
if: (children[i].origin == "premarital_with_spouse" and children[i].how_conceived == "premarital_surrogacy_with_spouse") or children[i].origin == "marital_surrogacy"
question: Your surrogacy agreement for ${children[i]}
subquestion: ${ collapse_template(why_ask_child_origin) }
fields:
  - Did you have a lawyer to make sure your surrogacy agreement was legally valid?: children[i].legal_parent
    datatype: radio
    choices:
      - Yes: both
      - No: neither
  - note: |
      There may be issues about legal parentage in your divorce.  
      
      **Before you use this tool to get divorce forms, talk to a lawyer.** ${MLH_GUIDE_FULL} 
      
      To learn more, read [How to Become a Legal Parent](https://michiganlegalhelp.org/resources/family/how-become-legal-parent).
    show if:
      variable: children[i].legal_parent
      is: neither
validation code: |
  if children[i].legal_parent == "neither": 
    validation_error("You need to talk to a lawyer to confirm the validity of your surrogacy agreement before continuing.")
---
id: premarital children with third party user is original parent
if: children[i].timing == "premarital" and children[i].origin == "premarital_with_another" and children[i].bio_parent == "user"
question: ${children[i]}'s legal parents 
subquestion: ${ collapse_template(why_ask_child_origin) }
fields:
  - Did your spouse become ${children[i]}'s legal parent?: children[i].parentage_established
    datatype: radio
    choices:
      - "**No**": no
      - Yes, they became ${children[i]}'s legal parent through **stepparent adoption**.: stepparent_adoption
      - Yes, they became ${children[i]}'s legal parent by an **Affidavit of Parentage.**: affidavit
      - Yes, they became ${children[i]}'s legal parent by a **court order** of parentage (for example, an *Order of Filiation* or a *Judgment of Parentage*).: court_order
  - How was ${children[i]} conceived?: children[i].how_conceived
    datatype: radio
    choices:
      - By sexual intercourse: sex   # trigger revocation questions and message
      - By assisted reproduction: assisted_reproduction # trigger complicated issue kickout
    js show if: |
      val("children[i].parentage_established") == "affidavit" || val("children[i].parentage_established") == "court_order"
---
id: premarital children with third party spouse is original parent
if: children[i].timing == "premarital" and children[i].origin == "premarital_with_another" and children[i].bio_parent == "other_party"
question: ${children[i]}'s legal parents 
subquestion: ${ collapse_template(why_ask_child_origin) }
fields:
  - Did you become ${children[i]}'s legal parent?: children[i].parentage_established
    datatype: radio
    choices:
      - "**No**": no
      - Yes, I became ${children[i]}'s legal parent through **stepparent adoption**.: stepparent_adoption
      - Yes, I became ${children[i]}'s legal parent by an **Affidavit of Parentage.**: affidavit
      - Yes, I became ${children[i]}'s legal parent by a **court order** of parentage (for example, an *Order of Filiation* or a *Judgment of Parentage*).: court_order
  - How was ${children[i]} conceived?: children[i].how_conceived
    datatype: radio
    choices:
      - By sexual intercourse: sex   # trigger revocation questions and message
      - By assisted reproduction: assisted_reproduction # trigger complicated issue kickout
    js show if: |
      val("children[i].parentage_established") == "affidavit" || val("children[i].parentage_established") == "court_order"
---
id: parentage revocation questions, user is bio parent
if: ((children[i].origin == "premarital_with_another" and (children[i].parentage_established == "affidavit" or children[i].parentage_established == "court_order") and children[i].how_conceived == "sex") or (children[i].origin == "marital_third_party_conceived")) and children[i].bio_parent == "user"
Question: Legal parentage status for ${children[i]}
fields:
  - Has your spouse's parentage been revoked (canceled) by a court order? This would only happen if you, your spouse, or ${children[i]}’s other biological parent filed a complaint or motion to revoke parentage, and the judge granted it.: children[i].legal_parent
    datatype: radio
    choices:
      - Yes: user
      - No: both
  - Do you want to ask the court to revoke (cancel) your spouse's legal parentage of ${children[i]} as part of your divorce case?: children[i].parentage_plan_to_revoke
    datatype: radio
    choices:
      - Yes, I want to ask the court to revoke my spouse's parentage.: True
      - No, I want my spouse to continue as legal parent.: False
    js show if: |
      val("children[i].legal_parent") == "both"
---
id: parentage revocation questions, spouse is bio parent
if: ((children[i].origin == "premarital_with_another" and (children[i].parentage_established == "affidavit" or children[i].parentage_established == "court_order") and children[i].how_conceived == "sex") or (children[i].origin == "marital_third_party_conceived")) and children[i].bio_parent == "other_party"
Question: Legal parentage status for ${children[i]}
fields:
  - Has your parentage been revoked (canceled) by a court order? This would only happen if you, your spouse, or ${children[i]}’s other biological parent filed a complaint or motion to revoke parentage, and the judge granted it.: children[i].legal_parent
    datatype: radio
    choices:
      - Yes: other_party
      - No: both
  - Do you want to ask the court to revoke (cancel) your legal parentage of ${children[i]} as part of your divorce case?: children[i].parentage_plan_to_revoke
    datatype: radio
    choices:
      - Yes, I want to ask the court to revoke my parentage.: True
      - No, I want to continue as legal parent.: False
    js show if: |
      val("children[i].legal_parent") == "both"
---
id: info about revoking parentage
if: ((children[i].origin == "premarital_with_another" and (children[i].parentage_established == "affidavit" or children[i].parentage_established == "court_order") and children[i].how_conceived == "sex") or (children[i].origin == "marital_third_party_conceived" and children[i].legal_parent == "both")) and children[i].parentage_plan_to_revoke
continue button field: children[i].parentage_revocation_info
question: Information about revoking parentage
subquestion: |
  % if children[i].origin == "premarital_with_another":
  
  % if children[i].parentage_established == "affidavit":
  
  % if children[i].bio_parent == "other_party":
  To do this, you can file a [Complaint/Motion and Affidavit to Revoke Acknowledgment of Parentage](https://www.courts.michigan.gov/49302a/siteassets/forms/scao-approved/cc435_new.pdf) along with the forms you file to start your divorce case. You may want to consider finding a lawyer to help you.
      
  If the judge revokes your parentage before your divorce is final, you will need to update the Judgment of Divorce before presenting it to the judge. You can do this by returning to this tool and changing your answer to the question that asks if parentage of ${children[i]} was revoked, then re-downloading the Judgment of Divorce form.
  
  % elif children[i].bio_parent == "user":
  To do this, you can file a [Complaint/Motion and Affidavit to Revoke Acknowledgment of Parentage](https://www.courts.michigan.gov/49302a/siteassets/forms/scao-approved/cc435_new.pdf) along with the forms you file to start your divorce case. You may want to consider finding a lawyer to help you.
      
  If the judge revokes your spouse's parentage before your divorce is final, you will need to update the Judgment of Divorce before presenting it to the judge. You can do this by returning to this tool and changing your answer to the question that asks if parentage of ${children[i]} was revoked, then re-downloading the Judgment of Divorce form.
  % endif

  % elif children[i].parentage_established =="court_order":
  
  % if children[i].bio_parent == "other_party":
  To do this, you can file a [Motion to Set Aside Order of Filiation](https://www.courts.michigan.gov/4a8194/siteassets/forms/scao-approved/cc437.pdf) in the same case that the Order of Filiation was entered in. You may want to consider finding a lawyer to help you.
  
  If the judge revokes your parentage before your divorce is final, you will need to update the Judgment of Divorce before presenting it to the judge. You can do this by returning to this tool and changing your answer to the question that asks if parentage of ${children[i]} was revoked, then re-downloading the Judgment of Divorce form.

  % elif children[i].bio_parent == "user":
  To do this, file a [Motion to Set Aside Order of Filiation](https://www.courts.michigan.gov/4a8194/siteassets/forms/scao-approved/cc437.pdf) in the same case that the Order of Filiation was entered in. You may want to consider finding a lawyer to help you.

  If the judge revokes your spouse’s parentage before your divorce is final, you will need to update the Judgment of Divorce before presenting it to the judge. You can do this by returning to this tool and changing your answer to the question that asks if parentage of ${children[i]} was revoked, then re-downloading the Judgment of Divorce form.
  % endif
  % endif
  
  % elif children[i].origin == "marital_third_party_conceived":
  
  % if children[i].bio_parent == "other_party":
  If the judge revokes your parentage before your divorce is final, you will need to update the Judgment of Divorce before presenting it to the judge. You can do this by returning to this tool and changing your answer to the question that asks if parentage of ${children[i]} was revoked, and then re-downloading the Judgment of Divorce form.

  You, your spouse, or the child's other biological parent can file a motion as part of your divorce case asking the judge to revoke (undo) your legal parentage. To prepare this motion, use the [Do-It-Yourself Revoke Parentage Established by Marriage tool](https://michiganlegalhelp.org/resources/family/do-it-yourself-revoke-parentage-established-marriage). You will need to start the divorce case before you can file the parentage motion.

  If nobody files a Motion to Determine Child Born Out of Wedlock, you will remain a legal parent. This means the judge can award you custody and/or parenting time, and you may be responsible for paying child support. A motion to revoke parentage can also be filed after your divorce is final, but the judge may be less likely to grant the motion when the child is older. To learn more, go to the page that applies to you on the Michigan Legal Help website: [Revoking Marriage-Based Parentage: For the Mother or Birthing Parent](https://michiganlegalhelp.org/resources/family/revoking-marriage-based-parentage-mother-or-birthing-parent), or [Revoking Marriage-Based Parentage: For the Husband or Spouse](https://michiganlegalhelp.org/resources/family/revoking-marriage-based-parentage-husband-or-spouse).
  
  % elif children[i].bio_parent == "user":
  If the judge revokes your spouse's parentage before your divorce is final, you will need to update the Judgment of Divorce before presenting it to the judge. You can do this by returning to this tool and changing your answer to the question that asks if parentage of ${children[i]} was revoked, and then re-downloading the Judgment of Divorce form.

  You, your spouse, or the child's other biological parent can file a motion as part of your divorce case asking the judge to revoke (undo) your spouse's legal parentage. To prepare this motion, use the [Do-It-Yourself Revoke Parentage Established by Marriage tool](https://michiganlegalhelp.org/resources/family/do-it-yourself-revoke-parentage-established-marriage). You will need to start the divorce case before you can file the parentage motion.

  If nobody files a Motion to Determine Child Born Out of Wedlock, your spouse will remain a legal parent. This means the judge can award them custody and/or parenting time, and they may be responsible for paying child support. A motion to revoke parentage can also be filed after your divorce is final, but the judge may be less likely to grant the motion when the child is older. To learn more, go to the page that applies to you on the Michigan Legal Help website: [Revoking Marriage-Based Parentage: For the Mother or Birthing Parent](https://michiganlegalhelp.org/resources/family/revoking-marriage-based-parentage-mother-or-birthing-parent), or [Revoking Marriage-Based Parentage: For the Husband or Spouse](https://michiganlegalhelp.org/resources/family/revoking-marriage-based-parentage-husband-or-spouse).
  % endif
  % endif
---
id: info about nonmarital children
if: children[i].legal_parent != "both"
continue button field: children[i].not_included_in_divorce_info
question: Important!
subquestion: |
  % if children[i].legal_parent == "other_party":
  Because you are not ${children[i]}'s legal parent, ${children[i].familiar()} can't be included in the custody, parenting time, and child support sections of your judgment of divorce (final divorce order). 

    If you are concerned about your ability to be a part of ${children[i].familiar()}'s life, talk to a lawyer. ${MLH_GUIDE_FULL}
  % elif children[i].legal_parent == "user":
  Because your spouse is not ${children[i]}'s legal parent, ${children[i].familiar()} can't be included in the custody, parenting time, and child support sections of your judgment of divorce (final divorce order). 
  % endif
---
id: kickout for complex situations involving assisted reproduction
if: ((children[i].origin == "premarital_with_another" and (children[i].parentage_established == "affidavit" or children[i].parentage_established == "court_order")) or children[i].origin == "marital_third_party_conceived") and children[i].how_conceived == "assisted_reproduction"
event: children[i].complicated_issue_kickout
question: This tool is not right for you
subquestion: |
  We're sorry. You can't use this tool to make divorce forms. 
  
  Legal parentage of ${children[i]} may be a complicated issue in your divorce. You will need to find a lawyer to help you. ${MLH_GUIDE_FULL}
---
id: who is birth parent
if: (children[i].origin == "premarital_with_spouse" and children[i].how_conceived == "premarital_sex_or_assisted_repro_with_spouse") or children[i].origin == "marital_third_party_conceived"
question: ${children[i]}'s birth parent
subquestion: |
  ${ collapse_template(why_ask_child_origin) }
fields:
  - Who gave birth to ${children[i]}?: children[i].bio_parent
    datatype: radio
    choices:
      - I did.: user
      - My spouse did.: other_party
  - How was ${children[i]} conceived?: children[i].how_conceived
    datatype: radio
    choices:
      - By sexual intercourse: sex   # trigger revocation questions and message
      - By assisted reproduction: assisted_reproduction # trigger complicated issue kickout
    js show if: |
      (val("children[i].bio_parent") == "user" || val("children[i].bio_parent") == "other_party") && ${ json.dumps(children[i].origin) } === "marital_third_party_conceived"
---
# TODO: confirm usage of "under text"
id: children_target_number
question: |
  Children
subquestion: |
  Children together are those children who have both you and your spouse as legal parents, whether you became their parents during your marriage or before, not including stepchildren.
fields:
  - label: How many minor children do you and your spouse have together?
    field: children.target_number
    datatype: integer
    min: 1
---
id: display parentage interview for testing purposes
question: Parentage Result
continue button field: children[i].show_parentage_info
subquestion: |
  ${children[i]}'s legal parents is/are:

  % if children[i].legal_parent == "both":
  **Both** the user and their spouse. (Custody, etc., will be decided in the divorce.)
  % elif children[i].legal_parent == "user":
  **Only the user**. (${children[i].familiar()} will be listed as a stepchild only.)
  % elif children[i].legal_parent == "other_party":
  **Only the user's spouse**. 
  
  (${children[i].familiar()} will be listed as a stepchild only.)
  % endif

  origin code: ${children[i].origin}
  
  timing code: ${children[i].timing}
######## start custody questions #######
---
id: custody parenting time questions
question: |
  Custody and Parenting Time
subquestion: | 
  ${ collapse_template(custody_PT_guidance, collapsed=False) }
fields:
  - Who should have legal custody?: legal_custody_who
    datatype: radio
    choices:
      - Only me: user
      - Only my spouse: other_party
      - "Both of us, jointly": both
  - Who should have physical custody?: physical_custody_who
    datatype: radio
    choices:
      - Only me: user
      - Only my spouse: other_party
      - "Both of us, jointly": both
  - note: |
      Because you have selected joint physical custody, both parents will have parenting time.
    show if: 
      variable: physical_custody_who
      is: both
  - Who should have parenting time (visitation) with the children?: PT_who
    datatype: radio
    choices: 
      - Only me: user
      - Both of us: both
    show if:
      variable: physical_custody_who
      is: user
  - Who should have parenting time (visitation) with the children?: PT_who
    datatype: radio
    choices: 
      - Only my spouse: other_party
      - Both of us: both
    show if:
      variable: physical_custody_who
      is: other_party
  - What type of parenting time do you believe is appropriate?: PT_type
    datatype: radio
    choices:
      - Reasonable: reasonable
      - Specific: specific
    js show if: |
      val("PT_who") == "both" && val("physical_custody_who") == "both"
  - What type of parenting time do you believe is appropriate?: PT_type
    datatype: radio
    choices:
      - Reasonable: reasonable
      - Specific: specific
      - Specific and supervised: supervised
    js show if: |
      val("PT_who") == "both" && val("physical_custody_who") != "both"
  - note: |
      ${ collapse_template(custody_PT_definitions) }
---
if: PT_type == "specific"
id: specific parenting time options
question: |
  Specific Parenting Time Schedules
subquestion: | 
  You will need a specific parenting time schedule. If you are able to work with the other parent, you may want to come up with the schedule together.

  The [Michigan Parenting Time Guideline](https://www.courts.michigan.gov/4a537f/siteassets/court-administration/standardsguidelines/foc/pt_gdlns.pdf), created by the Friend of the Court Bureau, is a helpful resource for putting together a parenting time schedule. We recommend that you **review the Guideline before** creating a custom parenting time schedule for your family. 

  ${ collapse_template(MI_PT_guideline_info) }

  You may also be able to get a sample schedule from your county's Friend of the Court (FOC) office. Check their website or ask the Friend of the Court how to get one. 
  
  Another option is to use a sample schedule from Michigan Legal Help:

  ${ collapse_template(MLH_sample_schedules) }

  % if not user_logged_in():
  If you need time to pick a schedule, please create an account and sign in to save your answers for later.
  % endif
  
fields:
  - Do you want to write your own parenting time schedule or use a sample schedule?: specific_PT_how
    datatype: radio
    choices:
      - Write my own: custom
      - "Use a sample schedule from my county’s Friend of the Court office (If you choose this option, you can either find the schedule on your court website or ask the Friend of the Court how you can get one).": FOC_sample
      - "Use a [sample schedule](link) from Michigan Legal Help (click the link above to view these)": MLH_sample
  - Which Michigan Legal Help [sample schedule](link) would you like to use?: MLH_PT_selection
    datatype: radio
    choices: 
      - Schedule A - Joint Physical Custody: schedule_A
      - Schedule B - School-Age Children: schedule_B
      - Schedule C - Children Not Yet in School: schedule_c
      - Schedule D - Long Distance Policy: schedule_d
    show if:
      variable: specific_PT_how
      is: MLH_sample
---
template: MLH_sample_schedules
subject: |
  Tap here for Michigan Legal Help's sample schedules.
content: |
  Tap any of the links below to download a PDF showing that sample parenting time schedule. 

  Schedule A - Joint Physical Custody
  
  Schedule B - School-Age Children
  
  Schedule C - Children Not Yet in School
  
  Schedule D - Long Distance Policy
---
template: MI_PT_guideline_info
subject: |
  More information about the Michigan Parenting Time Guideline
content: |
  The [Michigan Parenting Time Guideline](https://www.courts.michigan.gov/4a537f/siteassets/court-administration/standardsguidelines/foc/pt_gdlns.pdf) includes sample schedules you can use as a starting place to create your family's schedule. It also has information about the developmental needs of children at different ages in connection to parenting time. The Guideline addresses specific topics such as long distance parenting time, parenting time with a parent who is in prison, and domestic violence situations.
---
template: custody_PT_guidance
subject: |
  How to answer the custody and parenting time questions:
content: |
  % if divorce_custody_interview_ID == "JOD_only":
  
  1. If the **judge issued temporary orders** for custody or {parenting time}, you should match the judge's orders.
  
  2. If there are **no temporary orders** for custody or {parenting time}:
      * if you and your spouse **agree** on a question, use your agreed answer.
      * if you and your spouse **don't agree** on a question, use the custody and parenting time terms that you want the judge to order.
  
  % elif divorce_custody_interview_ID == "divorce_complaint":
  * If you and your spouse **agree** on a question, use your agreed answer.
  * If you and your spouse **don't agree** on a question, use the custody and parenting time terms that you want the judge to order.

  You may have to come back to this tool later and change the custody and parenting time terms if you and your spouse change your agreement or if the judge orders terms that are different than those you enter now.  
  % if not user_logged_in():
  You must create an account and log in to save your answers.
  % endif
  % endif
---
template: custody_PT_definitions
subject: |
  What do these questions mean?
terms:
  noncustodial parent: |
    The "**noncustodial parent**" is the parent who does **not** have sole or primary physical custody of the children. 
    
    The "custodial parent" generally refers to the parent with whom the children live most of the time.
  
content: |
  ===== **Legal Custody** =====
  
  Having legal custody of your children means having the right to make important decisions about their lives, like where they go to school, what religion they are, and major medical decisions. Either parent can have sole legal custody, or parents can have joint legal custody. 
  
  When parents have joint legal custody, they both have the right to weigh in on important decisions about their kids. Both parents must agree on important decisions. If they can’t agree, they may have to ask the judge to decide. 
  
  If a parent has sole legal custody, that parent can make these important decisions without the other parent’s agreement.

  ===== **Physical Custody** =====
  
  Having physical custody of your children means your children will live with you at least some of the time. Either parent can have sole physical custody, or parents can have joint physical custody. 
  
  When parents have joint physical custody, the children take turns living with each parent. 
  
  If one parent has sole physical custody, the other parent will usually have regular parenting time, or “visitation,” with the children.

  ===== **Parenting Time Types** =====
  
  **Reasonable**: If a judge orders “reasonable” parenting time, specific dates, times, and other conditions are left for the parents to work out. If you believe that you and your spouse can agree on parenting time arrangements, you may ask for reasonable parenting time rather than a specific parenting time schedule. However, if the judge orders reasonable parenting time, and you and your spouse can’t agree, the judge may not be able to enforce the order or judgment. You will need to return to court and ask for a specific parenting time schedule in order for the judge to enforce the judgment.

  **Specific**: If a judge orders “specific” parenting time, all of the dates, times, and conditions for visits are included in the court order. Many counties have standard parenting time schedules that you can use in your case. You can contact the Friend of the Court in the county where your case will be filed and ask if there is a standard parenting time schedule. You can also choose one of our common parenting time schedules for families that have joint physical custody, for families with school-age children, for families with children younger than school age, or for long distance parenting time of school-age children.

  **Specific and supervised**: If a judge orders “specific and supervised” parenting time, all of the dates, times, and conditions for visits are included in the court order. The judge will order parenting time to be supervised by a third party – such as a relative, friend, or supervised parenting time center. Supervised parenting time may be appropriate if the {noncustodial parent} is a risk to the children. The supervisor must be willing to supervise parenting time.

######## end custody questions ########

---
event: test_end_screen
question: Thank you for testing!
subquestion: You have finished the initial child questions test interview.
